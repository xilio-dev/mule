<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.stackoka.stackoka.repository.follow.FollowsMapper">

    <select id="selectFans"   resultType="com.stackoka.stackoka.common.data.follow.FollowUserVO">
        SELECT
            u.id AS userId,
            u.username,
            u.avatar,
            u.description,
            CASE
                WHEN f2.user_id IS NOT NULL THEN 1
                ELSE 0
                END AS relation
        FROM
            follows AS f
                JOIN
            user AS u ON f.user_id = u.id
                LEFT JOIN
            follows AS f2 ON f2.target_user_id = f.user_id AND f2.user_id = #{visitorUserId}
        WHERE
            f.target_user_id = #{userId}
    </select>
    <select id="selectFollow" resultType="com.stackoka.stackoka.common.data.follow.FollowUserVO">
                SELECT  u.id    AS userId,
               u.username,
               u.avatar,
               u.description,
               CASE
                   WHEN f2.user_id IS NOT NULL THEN 1
                   ELSE 0
                   END AS relation
        FROM follows AS f
                 JOIN
             user AS u ON f.target_user_id = u.id
                 LEFT JOIN
             follows AS f2 ON f2.target_user_id = f.target_user_id AND f2.user_id = #{visitorUserId}
        WHERE f.user_id = #{userId}


    </select>
</mapper>
